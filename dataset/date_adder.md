# ุชูุถุญุงุช ฺฉุฏ ุงูุฒูุฏู ุณุชููโูุง ุชุงุฑุฎ ุญูุงุฑ ุจู ุฏุชุงุณุชโูุง FDMS

---

## ูุฏู ฺฉุฏ
ุงู ุงุณฺฉุฑูพุช ุจุฑุง ุงูุฒูุฏู ุฏู ุณุชูู ุชุงุฑุฎ ุจู ุฏุชุงุณุชโูุง ุญูุงุฑ ฺุงูโูุง ุฏุฑ ูุงูุจ ูุงูโูุง Parquet ุงุณุชูุงุฏู ูโุดูุฏ:

- **spud_date**: ุชุงุฑุฎ ุดุฑูุน ุญูุงุฑ (ุดุฑูุน ุนููุงุช ฺุงู)
- **completion_date**: ุชุงุฑุฎ ูพุงุงู ุญูุงุฑ (ุงุชูุงู ุนููุงุช ฺุงู)

---

## ูุฑูุฏโูุง
- ูุณุฑ ูุฑูุฏ ูุงูโูุง ุฏุฑ ูุชุบุฑ `input_dir` ูุดุฎุต ุดุฏู ุงุณุช (`fdms_well_datasets`).
- ูุงูโูุง ูุฑูุฏ ุจุงุฏ ูุฑูุช Parquet ุฏุงุดุชู ุจุงุดูุฏ.

---

## ุดุฑุญ ุนููฺฉุฑุฏ ฺฉุฏ

### 1. ุชููุฏ ุชุงุฑุฎโูุง

- ุชุงุจุน `generate_dates(num_rows)` ุจุฑุง ุชููุฏ ุฏู ูุณุช ุชุงุฑุฎ ุงุณุชูุงุฏู ูโุดูุฏ:

  - **spud_date**: ุชุงุฑุฎ ุดุฑูุน ุญูุงุฑ ฺฉู ุจู ุตูุฑุช ุชุตุงุฏู ุฏุฑ ุจุงุฒู 3 ุณุงู ุงุฒ 1 ฺุงููู 2020 ุชููุฏ ูโุดูุฏ.
  
  - **completion_date**: ุชุงุฑุฎ ูพุงุงู ุญูุงุฑ ฺฉู ุจู ต ุชุง นฐ ุฑูุฒ ูพุณ ุงุฒ `spud_date` ูุฑุงุฑ ุฏุงุฑุฏ.

### 2. ุฎูุงูุฏู ู ูพุฑุฏุงุฒุด ูุงูโูุง

- ุงุณฺฉุฑูพุช ูุงุฑุฏ ูพูุดู `fdms_well_datasets` ุดุฏู ู ุชูุงู ูุงูโูุง ุจุง ูพุณููุฏ `.parquet` ุฑุง ุดูุงุณุง ูโฺฉูุฏ.
- ุจุฑุง ูุฑ ูุงู:
  - ูุงู ุฑุง ุจุง `pandas.read_parquet` ุจู ฺฉ ุฏุชุงูุฑู ุชุจุฏู ูโฺฉูุฏ.
  - ุชุงุฑุฎโูุง `spud_date` ู `completion_date` ุฑุง ุชููุฏ ู ุจู ุฏุชุงูุฑู ุงุถุงูู ูโฺฉูุฏ.
  - ุณุชููโูุง ุฑุง ูุฑุชุจ ูโฺฉูุฏ ุชุง ุชุฑุชุจ ุจู ุตูุฑุช ุฒุฑ ุจุงุดุฏ:
    1. `WELL_ID`
    2. `spud_date`
    3. `completion_date`
    4. ุณุงุฑ ุณุชููโูุง
  - ุฏุชุงูุฑู ุจู ููุงู ูุณุฑ ู ูุฑูุช Parquet ุฐุฎุฑู ูโุดูุฏ.

---

## ูฺฉุงุช ููู

- ุชุงุฑุฎโูุง ุชููุฏ ุดุฏู ุจู ุตูุฑุช ุชุตุงุฏู ูุณุชูุฏ ู ุฏุฑ ูุฑ ุงุฌุฑุง ฺฉุฏ ุชุบุฑ ูโฺฉููุฏ.
- ุงฺฏุฑ ูุงุฒ ุจู ุชฺฉุฑุงุฑูพุฐุฑ ุฏุงุฑุฏุ ูโุชูุงูุฏ ูุจู ุงุฒ ุชููุฏ ุชุงุฑุฎโูุง ุงุฒ `np.random.seed()` ุงุณุชูุงุฏู ฺฉูุฏ.
- ูุฑุชุจ ฺฉุฑุฏู ุณุชููโูุง ฺฉูฺฉ ูโฺฉูุฏ ุชุง ุงุทูุงุนุงุช ฺฉูุฏ ุฑุงุญุชโุชุฑ ุฏุฑ ุฏุณุชุฑุณ ุจุงุดูุฏ.
- ฺฉุฏ ูุงูโูุง ุงุตู ุฑุง ุจุง ูุณุฎู ุฌุฏุฏ ุจุงุฒููุณ ูโฺฉูุฏ.

---

## ููููู ฺฉุฏ ุงุตู

```python
def generate_dates(num_rows):
    base_date = datetime(2020, 1, 1)
    spud_dates = [base_date + timedelta(days=int(np.random.uniform(0, 365*3))) for _ in range(num_rows)]
    completion_dates = [spud + timedelta(days=int(np.random.uniform(5, 90))) for spud in spud_dates]
    return spud_dates, completion_dates

for filename in os.listdir(input_dir):
    if filename.endswith(".parquet"):
        filepath = os.path.join(input_dir, filename)
        print(f"๐ ุฏุฑ ุญุงู ูพุฑุฏุงุฒุด ูุงู: {filename}")

        df = pd.read_parquet(filepath)

        spud_dates, completion_dates = generate_dates(len(df))
        df["spud_date"] = spud_dates
        df["completion_date"] = completion_dates

        first_cols = ["WELL_ID", "spud_date", "completion_date"]
        remaining_cols = [col for col in df.columns if col not in first_cols]
        df = df[first_cols + remaining_cols]

        df.to_parquet(filepath, index=False)
        print(f"โ ุณุชููโูุง ุงูุฒูุฏู ู ูุงู ุฐุฎุฑู ุดุฏ: {filename}")
